var DTHELPER=function(){if(void 0===$)throw new TypeError("DTHELPER's JavaScript requires jQuery!");var t={deleteButton:function(t,e){return HELPER.Html.buttonTag(e+".onDelete('"+t+"')","btn btn-xs text-danger","Delete",'<i class="fas fa-times-circle"></i>')},editButton:function(t,e){return HELPER.Html.buttonTag(e+".onEdit('"+t+"')","btn btn-xs text-info","Edit",'<i class="fa fa-pencil-alt"></i>')},getActionHref:function(o,s){return{header:"Aksi",width:"100px",className:"text-center",render:function(t,e,n,a){var i=HELPER.Html.aHref(o+t,"btn btn-xs text-info","Edit",'<i class="fa fa-pencil-alt"></i>');return i+=HELPER.Html.aHref(s+t,"btn btn-xs text-danger","Delete",'<i class="fas fa-times-circle"></i>')}}}};return t}();function DtBuilder(t,e){var n=this;n.instance=null;(window[t]=n).name=t,n.options=$.extend({method:"GET",addModal:!1,extraButtons:"",deleteUrl:""},e),$(function(){n._init()})}function ModalFormBuilder(t,e){var n={idValue:0,name:this.name=t,findUrl:"",saveUrl:"",fields:[],className:""};(window[t]=this).defaultIdValue=0,this.options=$.extend(n,e)}(function(){this.th=function(t){return"<th>"+t+"</th>"},this.tr=function(t){return"<tr>"+t+"</tr>"},this._init=function(){this.buildButtons(),this.buildTableHeader(),this.buildDataTable()},this.buildButtons=function(){var t=this.name,e=this.options,n="";e.extraButtons&&(n+=e.extraButtons),e.addModal&&(n+=' <button type="button" onclick="'+t+'_FORM.onShow()" class="btn btn-success btn-sm" title="Add"><i class="fas fa-plus-circle"></i></button>'),$("#main-table-buttons").html(n)},this.buildTableHeader=function(){for(var t="",e=this.options.id,n=this.options.fields,a=0;a<n.length;a++){var i=n[a];t+=this.th(i.header)}var o=$("#"+e).find("thead")[0];$(o).html(this.tr(t))},this.onDelete=function(n){var a=this;HELPER.Confirm.delete(function(){var t=a.options.deleteUrl,e={};e.id=n,HELPER.Html.loading(),SERVER.get(t,e,"json",function(t){HELPER.Html.loading(!1);var e=t.status;HELPER.Notify.notif(t.status,t.message),HELPER.Respone.isSuccess(e)&&a.refresh()},function(t,e,n){HELPER.Html.loading(!1),HELPER.Notify.failJqhr(t,e,n)})})},this.refresh=function(){self.instance.draw()},this.buildDataTable=function(){for(var t=this.options.id,e=this.options.url,n=this.options.method,a=this.options.fields,i=!1,o=[],s=0;s<a.length;s++){var r=a[s];!0===(r=$.extend({className:"",searchable:!1,name:"",orderable:!1,width:null,render:function(t,e,n,a){return t}},r)).searchable&&(i=!0);var l={};l.className=r.className,l.searchable=r.searchable,l.orderable=r.orderable,l.width=r.width,l.name=r.name,l.render=r.render,l.targets=s,o.push(l)}var c={ajax:{url:e,type:n},serverSide:!0,processing:!0,searching:i,order:[],columnDefs:o};self.instance=$("#"+t).DataTable(c)}}).call(DtBuilder.prototype),function(){this.renderField=function(t){var e=t.type,n=t.name,a=t.name,i=t.placeholder?t.placeholder:"",o=t.dataSource?t.dataSource:{},s='<div class="form-group '+(t.required?"required":"")+'">';switch(s+='<label for="'+t.name+'">'+t.label+"</label>",e){case"password":s+='<div class="input-group input-group-sm">',s+='<input type="password" class="form-control" id="'+n+'" name="'+a+'" placeholder="'+i+'">',s+='<div class="input-group-append">',s+='<span class="input-group-text"><i class="fa fa-key"></i></span>',s+="</div>",s+="</div>";break;case"textarea":s+='<textarea rows="5" class="form-control form-control-sm" id="'+n+'" name="'+a+'" placeholder="'+i+'"></textarea>';break;case"select":for(var r in s+='<select class="form-control input-sm select2" id="'+n+'" name="'+a+'" data-placeholder="'+i+'">',o){if(o.hasOwnProperty(r))s+='<option value="'+r+'">'+o[r]+"</option>"}s+="</select>";break;default:s+='<input type="text" class="form-control form-control-sm" id="'+n+'" name="'+a+'" placeholder="'+i+'">'}return s+="</div>"},this.populateValue=function(t){for(var e=this.options.fields,n=0;n<e.length;n++){var a=e[n],i=a.name,o=a.type,s=t[i]?t[i]:"";switch(o){case"select":$("#"+i).val(s).trigger("change");break;default:$("#"+i).val(s)}}},this.renderForm=function(){for(var t=this.options,e=t.className,n=t.fields,a="",i=0;i<n.length;i++){var o=n[i];a+=this.renderField(o)}$("#modal-form-fields").html(a),$(document).find(".select2:enabled").select2({theme:"bootstrap"}),$("#main-modal").modal({backdrop:"static"}),$(".modal-dialog").addClass(e),$("#main-modal-submit-button").attr("onclick",this.name+".submit(event)")},this.onShow=function(){this.options.idValue=this.defaultIdValue,this.renderForm(),$("#main-modal-submit-button").html('<i class="fa fa-save"></i> Simpan')},this.onEdit=function(t){var n=this,e=this.options;e.idValue=t;var a={};a.id=t;var i=e.findUrl;HELPER.Html.loading(),SERVER.get(i,a,"json",function(t){HELPER.Html.loading(!1);var e=t.status;HELPER.Respone.isSuccess(e)?(n.renderForm(),$("#main-modal-submit-button").html('<i class="fa fa-save"></i> Ubah'),n.populateValue(t.record)):HELPER.Notify.notif(t.status,t.message)},function(t,e,n){HELPER.Html.loading(!1),HELPER.Notify.failJqhr(t,e,n)})},this.submit=function(t){var o=this.options,e=o.idValue,n={};n.id=e;for(var a=$("#modal-form").serializeArray(),i=0;i<a.length;i++){var s=a[i];n[s.name]=s.value}var r=o.saveUrl;HELPER.Html.loading(),SERVER.post(r,n,"json",function(t,e,n){HELPER.Html.loading(!1);var a=t.status;if(HELPER.Notify.notif(t.status,t.message),HELPER.Respone.isSuccess(a)){var i=o.table;window[i]&&window[i].refresh(),$("#main-modal").modal("hide")}},function(t,e,n){HELPER.Html.loading(!1),HELPER.Notify.failJqhrReload(t,e,n)})}}.call(ModalFormBuilder.prototype),toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!1,showDuration:"200",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var HELPER=function(a){if(void 0===a)throw new TypeError("HELPER's JavaScript requires jQuery !");var t,e={},n={isSuccess:function(t){return"success"===t}},i={delete:function(e){Swal.fire({title:"Kamu yakin menghapus data ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus !",cancelButtonText:"Batal",allowOutsideClick:!1}).then(function(t){t.value&&e()})}},o=((t={}).notif=s,t.success=function(t,e){s("success",t,e)},t.error=function(t,e){s("error",t,e)},t.warning=function(t,e){s("error",t,e)},t.info=function(t,e){s("info",t,e)},t.failJqhr=r,t.failJqhrReload=function(t,e,n){r(t,0,n,function(){location.reload()})},t);function s(t,e,n){var a=function(){console.log("notify callback!")};null!=n&&(a=n);var i=e,o="Error tidak diketahui!";HELPER.isset(t)||(t="null",i=o);-1===["success","info","warning","error","null"].indexOf(t)&&(t="error",HELPER.isset(e)||(i=o));var s=null;switch(t){case"info":toastr.info(e,"Info");break;case"warning":toastr.warning(e,"Peringatan");break;case"success":s=Swal.fire({icon:"success",title:"Success",html:i,allowOutsideClick:!1,customClass:{content:"text-success"}});break;case"error":s=Swal.fire({icon:"error",title:"Error",html:i,allowOutsideClick:!1,customClass:{content:"text-danger"}});break;case"null":s=Swal.fire({icon:"error",title:"Error Not Found",html:i,allowOutsideClick:!1,customClass:{content:"text-danger"}});break;default:s=Swal.fire({icon:"error",title:t,html:i,allowOutsideClick:!1,customClass:{content:"text-danger"}})}HELPER.isset(s)&&s.then(function(t){a()}),toastr.subscribe(function(){a()})}function r(t,e,n,a){var i=function(){};null!=a&&(i=a),"object"==typeof n?s("",n.message,i):s(t.statusText,t.status+"-"+t.statusText,i)}var l={aHref:function(t,e,n,a){return'<a href="'+t+'" class="'+e+'" title ="'+n+'">'+a+"</a>"},aHref:function(t,e,n,a){return'<a href="'+t+'" class="'+e+'" title ="'+n+'">'+a+"</a>"},aTag:function(t,e,n,a){return'<a href="javascript:void(0)" onclick="'+t+'" class="'+e+'" title ="'+n+'">'+a+"</a>"},buttonTag:function(t,e,n,a){return'<button onclick="'+t+'" class="'+e+'" title ="'+n+'">'+a+"</button>"},loading:function(t){null==t?a("#spinner-front, #spinner-back").addClass("show"):a("#spinner-front, #spinner-back").removeClass("show")}};return e.isset=function(t){return!(null==t)},e.renewCsrfForm=function(t){var e=t.csrfName,n=t.csrfToken;a("input[name="+e+"]").val(n),console.log("renew csrf: "+n)},e.Respone=n,e.Notify=o,e.Confirm=i,e.Html=l,e}($),SERVER=function(l){if(void 0===l)throw new TypeError("SERVER's JavaScript requires jQuery!");function s(t,e,n,a,i,o){console.log(n);var s="json";HELPER.isset(a)&&(s=a);var r=l.ajax({url:e,type:t,data:n,dataType:s});r.done(i),r.fail(o)}var t={};return t.post=function(t,e,n,a,i){var o=Cookies.get(_CSRF_COOKIE);HELPER.isset(o)||(o=l("input[name="+_CSRF_NAME+"]").val()),e[_CSRF_NAME]=o;s("POST",t,e,n,function(t,e,n){HELPER.renewCsrfForm(t),HELPER.isset(a)?a(t,e,n):HELPER.Notify.notif(t.status,t.message)},function(t,e,n){HELPER.isset(i)?i(t,e,n):(HELPER.Html.loading(!1),HELPER.Notify.failJqhrReload(t,e,n))})},t.get=function(t,e,n,a,i){s("GET",t,e,n,function(t,e,n){HELPER.isset(a)?a(t,e,n):HELPER.Notify.notif(t.status,t.message)},function(t,e,n){HELPER.isset(i)?i(t,e,n):HELPER.Notify.failJqhr(t,e,n)})},t}($);